(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42a0438f"],{"11e6":function(e,t,i){},"55db":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"index"},[i("el-container",[i("el-main",{attrs:{id:"test"}},[i("div",{staticClass:"test"},[i("div",{staticClass:"table"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[i("el-form-item",{attrs:{label:"图片介绍"}},[i("span",[e._v(e._s(t.row.img_desc))])])],1)]}}])}),i("el-table-column",{attrs:{label:"图片标题","show-overflow-tooltip":!0,prop:"img_title"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"图片介绍",prop:"img_desc"}}),i("el-table-column",{attrs:{label:"图片详情",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"http://bsc-test-api.pgo.farm"+t.row.img_url,"preview-src-list":e.srcList}})]}}])}),i("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:e.creat}},[e._v("上传")])]}},{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.prev,"next-click":e.next}})],1),i("el-dialog",{attrs:{title:"add"===e.type?"新增图片":"修改图片",visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("imgs",{ref:"detail",attrs:{form:e.form,newFile:e.newFile,type:e.type},on:{cancel:e.cancel,changeTable:e.changeTable}})],1)],1)])],1)],1)},o=[],n=i("5530"),s=i("1da1"),l=(i("96cf"),i("159b"),i("498a"),{computed:{},data:function(){return{url:"",srcList:[],newFile:!1,total:0,page:1,type:"",form:{img_title:"",img_desc:""},formBackups:{img_title:"",img_url:"",img_desc:""},formLabelWidth:"120px",dialogFormVisible:!1,tableData:[],search:""}},mounted:function(){this.refreshTableData()},watch:{dialogFormVisible:function(e,t){console.log(e),e||(this.newFile=!1,this.$refs.detail.clear())}},methods:{refreshTableData:function(){var e=sessionStorage.getItem("imgsPage");console.log(e),null===e&&(e=1,console.log(e)),this.page=e,console.log(this.page),this.handleCurrentChange(e)},notify:function(e,t){switch(e){case 0:this.$notify.success({title:"公告管理",message:"".concat(t,"成功"),showClose:!1});break;case 1:this.$notify.error({title:"公告管理",message:"".concat(t,"失败"),showClose:!1});break;default:break}},getData:function(e){var t=this,i=this.$loading({lock:!0,text:"请求中"});this.$axiosBsc.post("/Image/fetchImg",{page:e}).then((function(e){i.close(),console.log(e);var a=e.data,o=a.msg,n=a.total,s=a.code;0==s?(t.tableData=[],t.total=0):(t.tableData=o,t.total=n,t.filtrationData())})).catch((function(e){i.close(),t.$message({message:e,type:"error"}),console.log(e)}))},formInit:function(e){this.form=e},filtrationData:function(){var e=this;this.tableData.forEach((function(t){e.srcList.push("http://bsc-test-api.pgo.farm"+t.img_url)}))},creat:function(){this.formInit({img_title:"",img_url:"",img_desc:""}),this.type="add",this.dialogFormVisible=!0},formHandel:function(){var e=this.form,t=this.$utils.delBlank,i=Object(n["a"])({},e);console.log(i),i.user_address=t(i.user_address),i.title=this.$.trim(i.title),i.comment=this.$.trim(i.comment);var a=i.user_address,o=i.title,s=i.comment,l=i.is_top,r=i.status,c=i.language;console.log(s),""===a||""===o||""===s||""===c?this.$message({message:"你有必选项未填",type:"warning"}):(i.is_top=l?1:0,i.status=r?1:0),console.log(i);var u=this.type;"add"===u?(console.log("添加"),this.addNotice(i)):(console.log("修改"),this.editNotice(i))},onSubmit:function(){this.formHandel()},onCancel:function(){this.dialogFormVisible=!1},prev:function(e){},next:function(e){},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.getData(e),sessionStorage.setItem("imgsPage",e),this.page=e},cancel:function(){this.dialogFormVisible=!1},changeTable:function(){this.dialogFormVisible=!1,this.refreshTableData()},handleEdit:function(e,t){var i=Object(n["a"])({},t);console.log(i),this.formInit(i),this.type="edit",this.dialogFormVisible=!0},handleDelete:function(e,t){var i=this;this.$confirm("此操作将删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.delImg(t)})).catch((function(){i.$message({type:"info",message:"已取消删除"})}))},delImg:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var a,o,n,s,l,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return console.log(e),a=e.id,o={id:a},i.prev=3,i.next=6,t.$reqBsc.removeImg(o);case 6:n=i.sent,console.log(n),s=n.data,l=s.code,r=s.msg,1==l?(t.$notify({title:"成功",message:r,type:"success"}),t.refreshTableData()):t.$notify.error({title:"错误",message:r}),i.next=15;break;case 12:i.prev=12,i.t0=i["catch"](3),console.log(i.t0);case 15:case"end":return i.stop()}}),i,null,[[3,12]])})))()}}}),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"index"},[i("el-container",[i("el-main",{attrs:{id:"test"}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"图片名称"}},[i("el-input",{model:{value:e.form.img_title,callback:function(t){e.$set(e.form,"img_title",t)},expression:"form.img_title"}})],1),i("el-form-item",{attrs:{label:"图片详情"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.form.img_url,expression:"form.img_url!==''"}],staticClass:"previewImg"},[i("el-image",{staticStyle:{width:"146px",height:"146px","border-radius":"4px"},attrs:{src:"http://bsc-test-api.pgo.farm"+e.form.img_url,"preview-src-list":["http://bsc-test-api.pgo.farm"+e.form.img_url]}}),i("i",{staticClass:"el-icon-delete",on:{click:e.selectImg}})],1),i("el-upload",{directives:[{name:"show",rawName:"v-show",value:""===e.form.img_url,expression:"form.img_url===''"}],ref:"upload",attrs:{"on-change":e.changeFile,action:"http://bsc-test-api.pgo.farm/api/Uploads/uploadImage","list-type":"picture-card","on-preview":e.handlePictureCardPreview,multiple:!1,"auto-upload":!1,limit:1,"on-remove":e.removeFile,beforeUpload:e.beforeUpload,"http-request":e.myUpload}},[i("i",{staticClass:"el-icon-plus"})]),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),i("el-form-item",{attrs:{label:"描述信息"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.img_desc,callback:function(t){e.$set(e.form,"img_desc",t)},expression:"form.img_desc"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认提交")]),i("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)],1)},c=[],u=(i("d3b7"),i("ac1f"),i("1276"),i("c19f"),i("ace4"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),{computed:{},mounted:function(){console.log(this.newFile)},data:function(){return{formBackups:{img_title:"",img_url:"",img_desc:""},file:"",uploadData:{upload:""},imageUrl:"",dialogImageUrl:"",dialogVisible:!1,url:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",srcList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]}},props:{form:{type:Object,default:{img_title:"",img_url:"",img_desc:""}},newFile:{type:Boolean,default:!1},type:{type:String,default:""}},components:{},methods:{update:function(e){var t=e.target.files[0];console.log(t);var i=new FormData;i.append("upload",t),i.append("chunk","0"),console.log(i.get("file"));var a={headers:{"Content-Type":"multipart/form-data"}};this.$axiosBsc.post("http://bsc-test-api.pgo.farm/api/Uploads/uploadImage",i,a).then((function(e){console.log(e.data)}))},nav:function(){this.$router.push("")},handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},changeFile:function(e,t){console.log(e),console.log(33333),this.newFile=!0},clear:function(){this.$refs.upload.clearFiles()},removeFile:function(e,t){this.newFile=!1},onSubmit:function(){console.log("submit!");var e=this.newFile,t=this.type;console.log(e,t);var i=this.form;console.log(i),i.img_desc=i.img_desc.trim(),i.img_title=i.img_title.trim(),""===i.img_desc||""===i.img_title?this.$notify({title:"警告",message:"请填写内容",type:"warning"}):"add"===t&&e?this.uploadImg():"add"!==t||e?"edit"!==t||e?"edit"===t&&e&&this.uploadImg():this.saveImage(i):this.$notify({title:"警告",message:"请上传图片",type:"warning"})},uploadImg:function(){this.$refs.upload.submit()},success:function(e,t,i){console.log(e,t,i)},fail:function(e,t,i){console.log(e,t,i)},beforeUpload:function(e){console.log(e),this.file=e},cancel:function(){this.$emit("cancel")},changeTable:function(){this.$emit("changeTable")},myUpload:function(){var e=this,t=this.file;console.log(t);var i=new FormData;i.append("upload",t),i.append("chunk","0"),console.log(i.get("file"));var a={headers:{"Content-Type":"multipart/form-data"}};this.$axiosBsc.post("http://bsc-test-api.pgo.farm/api/Uploads/uploadImage",i,a).then((function(t){var i=t.data,a=i.code,o=i.msg;console.log(a,o),1==a&&e.save(o)})).catch((function(e){console.log(e)}))},change:function(){},save:function(e){var t=this.form;t.img_url=e,t.img_desc=t.img_desc.trim(),t.img_title=t.img_title.trim(),""!==t.img_desc&&""!==t.img_title?this.saveImage(t):this.$notify({title:"警告",message:"请填写内容",type:"warning"})},saveImage:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var a,o,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.$reqBsc.saveImg(e);case 3:a=i.sent,console.log(a),o=a.data,n=o.code,s=o.msg,1==n?(t.$notify({title:"成功",message:s,type:"success"}),t.changeTable()):t.$notify.error({title:"错误",message:s}),i.next=13;break;case 9:i.prev=9,i.t0=i["catch"](0),console.log(i.t0),t.$notify.error({title:"错误",message:i.t0});case 13:case"end":return i.stop()}}),i,null,[[0,9]])})))()},selectImg:function(){this.form.img_url=""},getBase64:function(e){return new Promise((function(t,i){var a=new FileReader,o="";a.readAsDataURL(e),a.onload=function(){o=a.result},a.onerror=function(e){i(e)},a.onloadend=function(){t(o)}}))},toBytes:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var a,o,n,s,l;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.getBase64(e);case 3:for(a=i.sent,console.log(a),o=window.atob(a.split(",")[1]),n=new ArrayBuffer(o.length),s=new Uint8Array(n),l=0;l<o.length;l++)s[l]=o.charCodeAt(l);return i.abrupt("return",s);case 12:i.prev=12,i.t0=i["catch"](0),console.log(i.t0);case 15:case"end":return i.stop()}}),i,null,[[0,12]])})))()}}}),m=Object(n["a"])({},u),g=m,d=(i("dd9d"),i("2877")),f=Object(d["a"])(g,r,c,!1,null,"2dc6fb6a",null),p=f.exports,h=Object(n["a"])(Object(n["a"])({},l),{},{components:{imgs:p}}),b=h,v=(i("6428"),Object(d["a"])(b,a,o,!1,null,"4bb0cbc3",null));t["default"]=v.exports},6428:function(e,t,i){"use strict";i("7d73")},"7d73":function(e,t,i){},dd9d:function(e,t,i){"use strict";i("11e6")}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e9520636"],{3114:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index"},[n("el-container",[n("el-main",{attrs:{id:"test"}},[n("div",{staticClass:"test"},[n("el-row",{attrs:{gutter:12}},[n("el-col",{attrs:{span:6}},[n("el-card",{staticClass:"color",attrs:{shadow:"always"}},[t._v(" 待发放金额："),n("span",{staticClass:"success"},[t._v(t._s(Number(t.total.withdraw)>0?t.total.withdraw:0)+" PGO")])])],1),n("el-col",{attrs:{span:6}},[n("el-card",{staticClass:"color",attrs:{shadow:"always"}},[t._v(" 未处理数量："),n("span",{staticClass:"success"},[t._v(t._s(Number(t.total.num)>0?t.total.num:0))])])],1),n("el-col",{attrs:{span:6}},[n("el-card",{attrs:{shadow:"never"}})],1),n("el-col",{attrs:{span:6}},[n("el-card",{staticClass:"all",attrs:{shadow:"never"}},[n("el-button",{attrs:{type:"success"},on:{click:t.apprAll}},[t._v("全部授权")]),n("el-button",{attrs:{type:"danger"},on:{click:t.passAll}},[t._v("全部通过")])],1)],1)],1),n("div",{staticClass:"table"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[n("el-form-item",{attrs:{label:"申请人"}},[n("span",[t._v(t._s(e.row.inviter))])])],1)]}}])}),n("el-table-column",{attrs:{label:"创建时间",prop:"create_time"}}),n("el-table-column",{attrs:{label:"更新时间",prop:"updated_time"}}),n("el-table-column",{attrs:{label:"申请人"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(" "+t._s(t._f("dataFormat")(e.row.inviter))+" ")])]}}])}),n("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?n("span",{staticClass:"status"},[t._v(" 等待审核 ")]):t._e()]}}])}),n("el-table-column",{attrs:{label:"提现金额","show-overflow-tooltip":!0,prop:"withdraw"}}),n("el-table-column",{attrs:{label:"提现时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(" "+t._s(t._f("dateFormat")(e.row.withdraw_time))+" ")])]}}])}),n("el-table-column",{attrs:{align:"right",label:"人工审核"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:e.row.isAppr?"info":"primary"},on:{click:function(n){return t.appr(e.$index,e.row)}}},[t._v("授权")]),n("el-button",{attrs:{size:"mini",type:e.row.isAppr?"primary":"info"},on:{click:function(n){return t.pass(e.$index,e.row)}}},[t._v("通过")])]}}])})],1)],1),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.page,total:t.total.num},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"prev-click":t.prev,"next-click":t.next}})],1)],1)])],1)],1)},r=[],o=n("5530"),s=n("3835"),i=n("b85c"),c=n("1da1"),l=(n("96cf"),n("4d90"),n("d3b7"),n("25f0"),n("99af"),n("159b"),n("b64b"),n("07ac"),n("4fad"),n("498a"),n("a9e3"),n("3ca3"),n("ddb0"),n("ea52")),u={components:{},computed:{},filters:{dateFormat:function(t){var e=new Date(1e3*t),n=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,0),r=e.getDate().toString().padStart(2,0),o=e.getHours().toString().padStart(2,0),s=e.getMinutes().toString().padStart(2,0),i=e.getSeconds().toString().padStart(2,0);return n+"-"+a+"-"+r+" "+o+":"+s+":"+i},dataFormat:function(t){var e=t.substr(0,4),n=t.substr(t.length-4,t.length);return"".concat(e,"....").concat(n)}},data:function(){return{total:{num:0,withdraw:0},ERC20:{},InviterBonus:{},page:1,num:10,formLabelWidth:"120px",tableData:[]}},mounted:function(){var t=this,e=1;this.page=e,console.log(this.page),this.ERC20Init(),this.InviterBonusInit((function(){t.getToken()})),this.handleCurrentChange(e)},methods:{getToken:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.InviterBonus.Token();case 3:n=e.sent,console.log(n),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},ERC20Init:function(){var t=this;this.$DAppBSC.ERC20.init().then((function(e){t.ERC20=e,console.log(e)})).catch((function(t){alert(t)}))},InviterBonusInit:function(t){var e=this;this.$DAppBSC.InviterBonus.init().then((function(n){e.InviterBonus=n,console.log(e.InviterBonus),t&&t()})).catch((function(t){console.log(t)}))},notify:function(t,e){switch(t){case 0:this.$notify.success({title:"审核",message:"".concat(e,"成功"),showClose:!1});break;case 1:this.$notify.error({title:"审核",message:"".concat(e,"失败"),showClose:!1});break;default:break}},dialog:function(t){switch(t){case 0:this.$message({message:"请补充内容",type:"warning"});break;case 1:this.$notify({title:"操作成功",message:"恭喜您已经设置成功",type:"success"});break;case 2:this.$notify.error({title:"出现错误",message:"请查看控制台报错信息"});break;case 3:var e=this.$loading({lock:!0,text:"请求中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});break;case 4:e=this.$loading({lock:!0,text:"请求中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e.close();break;default:break}},getData:function(t){var e=this,n={p:t};this.$axiosBsc.post("home/getInviterWithdrawList",n).then((function(t){var n=t.data.data;console.log(n),console.log(t),e.convertArr(n).then((function(t){console.log(t,e.total),t.forEach((function(t){t.isAppr=!1})),e.tableData=t}))})).catch((function(t){console.log(t)}))},convertArr:function(t){var e=this;return new Promise((function(n,a){var r,o=[],c=(Object.keys,Object.values,Object.entries),l=Object(i["a"])(c(t));try{for(l.s();!(r=l.n()).done;){var u=Object(s["a"])(r.value,2),p=u[0],d=u[1];"withdraw"===p?e.total=d[0]:o.push(d)}}catch(h){l.e(h)}finally{l.f()}n(o)}))},onSubmit:function(){},onCancel:function(){},prev:function(t){},next:function(t){},handleSizeChange:function(t){console.log("每页 ".concat(t," 条"))},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),this.page=t,this.getData(t)},refreshData:function(){var t=this.page;console.log(t),this.getData(t)},withdraw:function(t,e,n){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.dialog(3),r.prev=1,r.next=4,a.InviterBonus.sendBonus(e,t);case 4:o=r.sent,console.log(o),s=o.status,s?(a.dialog(4),a.dialog(1),n&&n()):a.dialog(4),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](1),console.log(r.t0),a.dialog(4);case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))()},statusHandel:function(t,e){var n=this,a=t.id,r=t.inviter,o=t.withdraw;console.log(a,r,o);var s={id:a};this.withdraw(o,r,(function(){n.$axiosBsc.post("/home/applyWithdraw",s).then((function(t){console.log(t),n.refreshData(),n.notify(0,e)})).catch((function(t){console.log(t),n.notify(1,e)}))}))},pass:function(t,e){e.id;console.log(e),this.statusHandel(e,"通过")},send:function(t,e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(t,e),a.prev=1,a.next=4,n.InviterBonus.sendInviterBonus(t,e);case 4:r=a.sent,console.log(r),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),console.log(a.t0);case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},transfer:function(t,e){console.log(t,e);var n=e.inviter,a=e.withdraw;this.send(n.trim(),a.trim())},appr:function(t,e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var r,o,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.withdraw,console.log(r),n.dialog(3),a.prev=3,a.next=6,n.ERC20.authorization(l["a"].InviterBonusAddress,r);case 6:o=a.sent,console.log(o),s=o.status,s&&(n.dialog(4),n.dialog(1),n.tableData[t].isAppr=!0,console.log(n.tableData),i=JSON.stringify(n.tableData),n.tableData=JSON.parse(i)),a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](3),console.log(a.t0),n.dialog(4);case 16:case"end":return a.stop()}}),a,null,[[3,12]])})))()},totalWithdraw:function(){var t=this;return new Promise((function(e,n){var a=t.tableData;console.log(a);var r=0;a.forEach((function(t,e){var n=t.withdraw;n=Number(n),r+=n})),e(r)}))},apprAll:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,o,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(l["a"].InviterBonusAddress),n=t.totalWithdraw,a=t.tableData,!(a.length<=0)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,n();case 6:return r=e.sent,console.log(r),t.dialog(3),e.prev=9,e.next=12,t.ERC20.authorization(l["a"].InviterBonusAddress,r);case 12:o=e.sent,console.log(o),s=o.status,s&&(t.dialog(4),t.dialog(1),console.log(t.tableData),t.tableData.forEach((function(t){t.isAppr=!0})),i=JSON.stringify(t.tableData),t.tableData=JSON.parse(i)),e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](9),console.log(e.t0),t.dialog(4);case 22:case"end":return e.stop()}}),e,null,[[9,18]])})))()},toWei:function(t){var e=this;return new Promise((function(n,a){var r=e.InviterBonus.web3;t=r.utils.toWei(t.toString()),n(t)}))},allAmount:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],a=t.toWei,r=t.tableData,r.forEach((function(t){var e=t.withdraw,r=a(e);n.push(r)})),e.prev=4,e.next=7,Promise.all(n);case 7:return o=e.sent,e.abrupt("return",o);case 11:e.prev=11,e.t0=e["catch"](4),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})))()},getAddr:function(t){return new Promise((function(e,n){e(t)}))},allAddr:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getAddr,a=[],r=t.tableData,r.forEach((function(t){var e=t.inviter,r=n(e);a.push(r)})),e.prev=4,e.next=7,Promise.all(a);case 7:return o=e.sent,console.log(o),e.abrupt("return",o);case 12:e.prev=12,e.t0=e["catch"](4),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})))()},allIds:function(){var t=[],e=this.tableData;return e.forEach((function(e){var n=e.id;t.push(n)})),t},handleAll:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dialog(3),n=t.allIds,a=[],r=n(),r.forEach((function(e){var n={id:e},r=t.$axiosBsc.post("/home/applyWithdraw",n);a.push(r)})),e.prev=5,e.next=8,Promise.all(a);case 8:o=e.sent,console.log(o),t.dialog(4),t.refreshData(),t.dialog(1),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](5),console.log(e.t0),t.dialog(4);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})))()},passAll:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,o,s,i,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.allAddr,a=t.allAmount,r=t.handleAll,o=t.tableData,!(o.length<=0)){e.next=3;break}return e.abrupt("return");case 3:return t.dialog(3),e.next=6,n();case 6:return s=e.sent,e.prev=7,e.next=10,a();case 10:return i=e.sent,e.prev=11,e.next=14,t.InviterBonus.batchSendBonusHandle(s,i);case 14:c=e.sent,console.log(c),l=c.status,t.dialog(4),l&&r(),e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](11),console.log(e.t0),t.dialog(4);case 25:e.next=30;break;case 27:e.prev=27,e.t1=e["catch"](7),console.log(e.t1);case 30:case"end":return e.stop()}}),e,null,[[7,27],[11,21]])})))()}}},p=Object(o["a"])({},u),d=p,h=(n("efb5"),n("2877")),g=Object(h["a"])(d,a,r,!1,null,"72a4761c",null);e["default"]=g.exports},ccf7:function(t,e,n){},efb5:function(t,e,n){"use strict";n("ccf7")}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cac7637"],{"0f69":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddRole}},[e._v("新建用户")]),r("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.rolesList,border:""}},[r("el-table-column",{attrs:{align:"center",label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.user_name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"角色权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("roleFormat")(t.row.role_name))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"密码(加密)"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"psd"},[e._v(" "+e._s(t.row.user_pass)+" ")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"最后登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.last_login_time))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"登录IP"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.last_login_ip)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.handleEdit(t)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.handleDelete(t)}}},[e._v("删除")])]}}])})],1),r("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑信息":"新建用户"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{attrs:{model:e.role,"label-width":"80px","label-position":"left"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{placeholder:"用户名5~21位",maxlength:"21",minlength:"5","show-word-limit":""},model:{value:e.role.user_name,callback:function(t){e.$set(e.role,"user_name",t)},expression:"role.user_name"}})],1),r("el-form-item",{attrs:{label:"密码"}},[r("el-input",{attrs:{placeholder:"密码6~12位","show-password":"",maxlength:"12",minlength:"6","show-word-limit":""},model:{value:e.role.user_pass,callback:function(t){e.$set(e.role,"user_pass",t)},expression:"role.user_pass"}})],1),r("el-form-item",{attrs:{label:"角色权限"}},[r("el-radio-group",{model:{value:e.role.role_name,callback:function(t){e.$set(e.role,"role_name",t)},expression:"role.role_name"}},[r("el-radio",{attrs:{label:"admin"}},[e._v("管理员")]),r("el-radio",{attrs:{label:"editor"}},[e._v("编辑")]),r("el-radio",{attrs:{label:"visitor"}},[e._v("游客")])],1)],1)],1),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("确认")])],1)],1)],1)},a=[],s=r("5530"),o=r("1da1"),i=(r("96cf"),r("4d90"),r("d3b7"),r("25f0"),r("ac1f"),r("5319"),{filters:{roleFormat:function(e){var t;switch(e){case"admin":t="管理员";break;case"editor":t="编辑";break;default:t="游客"}return t},dateFormat:function(e){var t=new Date(1e3*e),r=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,0),a=t.getDate().toString().padStart(2,0),s=t.getHours().toString().padStart(2,0),o=t.getMinutes().toString().padStart(2,0),i=t.getSeconds().toString().padStart(2,0);return r+"-"+n+"-"+a+" "+s+":"+o+":"+i}},data:function(){return{dialogType:"new",dialogVisible:!1,rolesList:[],role:{},roleBackups:{user_name:"",role_name:"admin",user_pass:""}}},computed:{},mounted:function(){this.getUsers()},created:function(){},methods:{refresh:function(){this.getUsers()},formInit:function(){this.role=this.roleBackups},getUsers:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=1,n={is_delete:r},t.next=5,e.$reqBsc.getUsers(n);case 5:a=t.sent,s=a.data.msg,console.log(a),e.rolesList=s,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},handleAddRole:function(){this.formInit(),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){var t=e.row;console.log(t);var r=Object(s["a"])({},t);this.role=r,this.dialogType="edit",this.dialogVisible=!0},delete:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,s,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,n=e.user_id,a=0,s={user_id:n,is_delete:a},console.log(s),r.next=7,t.$reqBsc.removeUser(s);case 7:o=r.sent,console.log(o),i=o.data.code,1==i?(t.dialogVisible=!1,t.$message({type:"success",message:"删除成功!"}),t.refresh()):t.notify(0),r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),console.error(r.t0),t.notify(0);case 17:case"end":return r.stop()}}),r,null,[[0,13]])})))()},handleDelete:function(e){var t=this,r=(e.$index,e.row);console.log(r),this.$confirm("确认删除当前用户?","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.delete(r);case 1:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e),t.$message.error(e)}))},delBlank:function(e){return e.replace(/\s*/g,"")},notify:function(e){switch(e){case 1:this.$notify({title:"成功",message:"操作成功",type:"success"});break;default:this.$notify.error({title:"错误",message:"请求失败"});break}},checkData:function(e,t){console.log(e);var r=this.delBlank;e.user_name=r(e.user_name),e.user_pass=r(e.user_pass);var n=e.user_name,a=e.user_pass;e.role_id;""===n||""===a?this.$message.error("请补充内容"):n.length<5?this.$message.error("用户名最少5位"):a.length<6?this.$message.error("密码最少6位"):t&&t()},add:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$reqBsc.addUser(e);case 3:n=r.sent,console.log(n),a=n.data.code,1==a?(t.dialogVisible=!1,t.notify(1),t.refresh()):t.notify(0),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](0),console.error(r.t0),t.notify(0);case 13:case"end":return r.stop()}}),r,null,[[0,9]])})))()},addUser:function(e){var t=this.add;this.checkData(e,(function(){t(e)}))},update:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$reqBsc.editeUser(e);case 3:n=r.sent,console.log(n),a=n.data.code,1==a?(t.dialogVisible=!1,t.notify(1),t.refresh()):t.notify(0),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](0),console.error(r.t0),t.notify(0);case 13:case"end":return r.stop()}}),r,null,[[0,9]])})))()},updateUser:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=t.update,t.checkData(e,(function(){n(e)}));case 2:case"end":return r.stop()}}),r)})))()},confirmRole:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r="edit"===e.dialogType,n=e.role,a=e.updateUser,r?a(n):e.addUser(n);case 3:case"end":return t.stop()}}),t)})))()}}}),l=i,c=(r("40a4"),r("2877")),u=Object(c["a"])(l,n,a,!1,null,"f949b09e",null);t["default"]=u.exports},"184c":function(e,t,r){},"40a4":function(e,t,r){"use strict";r("184c")}}]);